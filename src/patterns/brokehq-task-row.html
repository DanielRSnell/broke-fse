<!-- BrokeHQ Task Row Component -->
<article class="group px-3 md:px-6">
  <div class="flex items-center gap-3 py-3 border-b border-neutral-200/70 last:border-0">
    <!-- Status Dot -->
    <div
      class="h-2.5 w-2.5 rounded-full"
      :class="{
        'bg-amber-400 ring-4 ring-amber-100': task.status === 'in-progress',
        'bg-yellow-400 ring-4 ring-yellow-100': task.status === 'todo',
        'bg-indigo-500 ring-4 ring-indigo-100': task.status === 'completed',
        'bg-neutral-400 ring-4 ring-neutral-100': !task.status
      }"
    ></div>

    <!-- Content -->
    <div class="min-w-0 flex-1">
      <div class="flex items-center gap-2">
        <!-- Task ID -->
        <span class="text-xs text-neutral-500">{{ task.company_prefix }}-{{ task.ID }}</span>

        <!-- Priority Badge -->
        <span
          v-if="task.meta('priority')"
          class="text-[10px] inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full"
          :class="{
            'bg-amber-50 text-amber-700 border border-amber-100': task.meta('priority') === 'high',
            'bg-neutral-100 text-neutral-700 border border-neutral-200': task.meta('priority') === 'medium' || task.meta('priority') === 'low'
          }"
        >
          <i
            data-lucide="alert-triangle"
            class="w-3 h-3"
            v-if="task.meta('priority') === 'high'"
          ></i>
          {{ task.meta('priority') | capitalize }}
        </span>

        <!-- Category/Type Badge -->
        <span
          v-if="task.category"
          class="text-[10px] inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full bg-neutral-100 border border-neutral-200"
        >
          <i data-lucide="git-branch" class="w-3 h-3"></i>
          {{ task.category }}
        </span>
      </div>

      <!-- Task Title -->
      <h3 class="text-sm font-medium tracking-tight truncate">{{ task.title }}</h3>
    </div>

    <!-- Metadata (Desktop Only) -->
    <div class="hidden md:flex items-center gap-2 text-xs text-neutral-600">
      <!-- Project Tag -->
      <span
        v-if="task.meta('parent_project')"
        class="inline-flex items-center gap-1 px-2 py-1 rounded-full bg-white border border-neutral-200"
      >
        <i data-lucide="app-window" class="w-3.5 h-3.5"></i>
        {{ task.meta('parent_project').post_title }}
      </span>

      <!-- Due Date -->
      <span v-if="task.meta('due_date')">{{ task.meta('due_date') | date('M j') }}</span>

      <!-- Assignee Avatar -->
      <img
        v-if="task.meta('assigned_to')"
        class="h-6 w-6 rounded-full object-cover"
        :src="task.meta('assigned_to').avatar"
        :alt="task.meta('assigned_to').display_name"
      >

      <!-- Loading Indicator (if task is processing) -->
      <i
        v-if="task.is_processing"
        data-lucide="loader"
        class="w-4 h-4 animate-spin text-neutral-400"
      ></i>
    </div>

    <!-- Completed Checkmark or Action Button -->
    <button
      v-if="task.status === 'completed'"
      class="p-1.5 rounded-md text-emerald-600"
      aria-label="Completed"
    >
      <i data-lucide="check" class="w-4 h-4"></i>
    </button>
    <button
      v-else
      class="opacity-0 group-hover:opacity-100 p-1.5 rounded-md hover:bg-neutral-100 transition-opacity"
      aria-label="Open task"
    >
      <i data-lucide="external-link" class="w-4 h-4"></i>
    </button>
  </div>
</article>
